<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1399" height="1440" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note over Portal_BE: User selects\n "deploy to k8s"
Portal_BE->Deployment\nClient: POST /deploy \n{solutionId, revisionId,\n envId, userId}
Deployment\nClient->CDS: POST /task {solId, revId, "taskCode": "DP",\n "statusCode": "ST", ...}
CDS->Deployment\nClient: 201 Created { ..., "taskId": <id>, ...}
Note over Deployment\nClient: Select job name per\n solution type\n(future feature)
Note over Jenkins: Jenkins jobs are preconfigured\n (simple, composite, pipeline)
Deployment\nClient->Jenkins: POST /job/solution-deploy/buildWithParameters?taskId=<id>
Jenkins->Deployment\nClient: 201 Created
Deployment\nClient->Portal_BE: 202 Accepted\n {taskId}
Note over Portal_BE: Monitor task/stepresult\n and update UI as needed
Note over Jenkins: Execute deployment job
Jenkins->Deployment\nClient: GET /getSolutionZip/<taskId>
Note over Deployment\nClient: package solution deployment\ntemplates etc for the\ntype of solution
Deployment\nClient->Jenkins: 202 OK (solution.zip)
Note over Jenkins: Unpack solution.zip,\nprepare for deployment
Jenkins->k8s_Master: Create solution deployment
Note over Jenkins: When deployment is complete provide\n notification text ("reason") ala\n'<SOLUTION_NAME> deployment is complete.\n The solution can be accessed at the\ningress URL <ingress>'
Jenkins->Deployment\nClient: POST /status/<taskId>\n {"status": "SU", "reason": "<reason>", ingress": "<url>"}
Deployment\nClient->CDS: POST /task/stepresult {taskId, "name": "DEP",\n "statusCode": "SU", ...}
Deployment\nClient->CDS: PUT /task/<taskId> {"statusCode": "SU", ...}
Deployment\nClient->CDS: POST /notif\n {"message": "<reason>", "url": <url>, ...}]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="72.9296875" y="20" width="107.0625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.9296875" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.9296875">Portal_BE</tspan></text></g><g class="actor"><rect x="72.9296875" y="1361.84375" width="107.0625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.9296875" y="1396.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.9296875">Portal_BE</tspan></text></g><line x1="126.4609375" x2="126.4609375" y1="78.1875" y2="1361.84375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="320.3046875" y="20" width="116.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="330.3046875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="330.3046875">Deployment</tspan><tspan dy="1.2em" x="330.3046875">Client</tspan></text></g><g class="actor"><rect x="320.3046875" y="1361.84375" width="116.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="330.3046875" y="1386.84375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="330.3046875">Deployment</tspan><tspan dy="1.2em" x="330.3046875">Client</tspan></text></g><line x1="378.6484375" x2="378.6484375" y1="78.1875" y2="1361.84375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="807.484375" y="20" width="49.265625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="817.484375" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="817.484375">CDS</tspan></text></g><g class="actor"><rect x="807.484375" y="1361.84375" width="49.265625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="817.484375" y="1396.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="817.484375">CDS</tspan></text></g><line x1="832.1171875" x2="832.1171875" y1="78.1875" y2="1361.84375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="995.875" y="20" width="88.796875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1006.875" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1005.875">Jenkins</tspan></text></g><g class="actor"><rect x="995.875" y="1361.84375" width="88.796875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1006.875" y="1396.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1005.875">Jenkins</tspan></text></g><line x1="1040.2734375" x2="1040.2734375" y1="78.1875" y2="1361.84375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1252.2421875" y="20" width="117.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1262.2421875" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1262.2421875">k8s_Master</tspan></text></g><g class="actor"><rect x="1252.2421875" y="1361.84375" width="117.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1262.2421875" y="1396.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1262.2421875">k8s_Master</tspan></text></g><line x1="1311.0859375" x2="1311.0859375" y1="78.1875" y2="1361.84375" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="49.21875" y="98.1875" width="154.484375" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="54.21875" y="118.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="54.21875">User selects</tspan><tspan dy="1.2em" x="54.21875">"deploy to k8s"</tspan></text></g><g class="signal"><text x="137.4609375" y="157.6796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="136.4609375">POST /deploy</tspan><tspan dy="1.2em" x="136.4609375">{solutionId, revisionId,</tspan><tspan dy="1.2em" x="136.4609375">envId, userId}</tspan></text><line x1="126.4609375" x2="378.6484375" y1="223.765625" y2="223.765625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="398.28125" y="244.671875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="398.28125">POST /task {solId, revId, "taskCode": "DP",</tspan><tspan dy="1.2em" x="398.28125">"statusCode": "ST", ...}</tspan></text><line x1="378.6484375" x2="832.1171875" y1="281.953125" y2="281.953125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="417.546875" y="312.453125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="417.546875">201 Created { ..., "taskId": &lt;id&gt;, ...}</tspan></text><line x1="832.1171875" x2="378.6484375" y1="320.953125" y2="320.953125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="281.453125" y="340.953125" width="194.390625" height="67.390625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="286.453125" y="360.953125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="286.453125">Select job name per</tspan><tspan dy="1.2em" x="286.453125">solution type</tspan><tspan dy="1.2em" x="286.453125">(future feature)</tspan></text></g><g class="note"><rect x="890.1015625" y="428.34375" width="300.34375" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="896.1015625" y="448.34375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="895.1015625">Jenkins jobs are preconfigured</tspan><tspan dy="1.2em" x="895.1015625">(simple, composite, pipeline)</tspan></text></g><g class="signal"><text x="434.7421875" y="507.03125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="434.7421875">POST /job/solution-deploy/buildWithParameters?taskId=&lt;id&gt;</tspan></text><line x1="378.6484375" x2="1040.2734375" y1="515.53125" y2="515.53125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="656.296875" y="546.03125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="656.296875">201 Created</tspan></text><line x1="1040.2734375" x2="378.6484375" y1="554.53125" y2="554.53125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="194.578125" y="575.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="194.578125">202 Accepted</tspan><tspan dy="1.2em" x="194.578125">{taskId}</tspan></text><line x1="378.6484375" x2="126.4609375" y1="612.71875" y2="612.71875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="10" y="632.71875" width="232.921875" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="16" y="652.71875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Monitor task/stepresult</tspan><tspan dy="1.2em" x="15">and update UI as needed</tspan></text></g><g class="note"><rect x="929.1328125" y="700.90625" width="222.28125" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="934.1328125" y="720.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="934.1328125">Execute deployment job</tspan></text></g><g class="signal"><text x="574.921875" y="760.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="573.921875">GET /getSolutionZip/&lt;taskId&gt;</tspan></text><line x1="1040.2734375" x2="378.6484375" y1="768.90625" y2="768.90625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="243.421875" y="788.90625" width="270.453125" height="67.390625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="248.421875" y="808.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="248.421875">package solution deployment</tspan><tspan dy="1.2em" x="248.421875">templates etc for the</tspan><tspan dy="1.2em" x="248.421875">type of solution</tspan></text></g><g class="signal"><text x="608.3203125" y="886.796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="608.3203125">202 OK (solution.zip)</tspan></text><line x1="378.6484375" x2="1040.2734375" y1="895.296875" y2="895.296875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="929.1328125" y="915.296875" width="222.28125" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="934.1328125" y="935.296875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="934.1328125">Unpack solution.zip,</tspan><tspan dy="1.2em" x="934.1328125">prepare for deployment</tspan></text></g><g class="signal"><text x="1050.2734375" y="993.984375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1050.2734375">Create solution deployment</tspan></text><line x1="1040.2734375" x2="1311.0859375" y1="1002.484375" y2="1002.484375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="842.1171875" y="1022.484375" width="396.3125" height="105.796875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="848.1171875" y="1042.484375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="847.1171875">When deployment is complete provide</tspan><tspan dy="1.2em" x="847.1171875">notification text ("reason") ala</tspan><tspan dy="1.2em" x="847.1171875">'&lt;SOLUTION_NAME&gt; deployment is complete.</tspan><tspan dy="1.2em" x="847.1171875">The solution can be accessed at the</tspan><tspan dy="1.2em" x="847.1171875">ingress URL &lt;ingress&gt;'</tspan></text></g><g class="signal"><text x="434.9296875" y="1149.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="434.9296875">POST /status/&lt;taskId&gt;</tspan><tspan dy="1.2em" x="434.9296875">{"status": "SU", "reason": "&lt;reason&gt;", ingress": "&lt;url&gt;"}</tspan></text><line x1="1040.2734375" x2="378.6484375" y1="1186.46875" y2="1186.46875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="388.6484375" y="1207.375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="388.6484375">POST /task/stepresult {taskId, "name": "DEP",</tspan><tspan dy="1.2em" x="388.6484375">"statusCode": "SU", ...}</tspan></text><line x1="378.6484375" x2="832.1171875" y1="1244.65625" y2="1244.65625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="393.4609375" y="1275.15625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="393.4609375">PUT /task/&lt;taskId&gt; {"statusCode": "SU", ...}</tspan></text><line x1="378.6484375" x2="832.1171875" y1="1283.65625" y2="1283.65625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="403.09375" y="1304.5625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="403.09375">POST /notif</tspan><tspan dy="1.2em" x="403.09375">{"message": "&lt;reason&gt;", "url": &lt;url&gt;, ...}</tspan></text><line x1="378.6484375" x2="832.1171875" y1="1341.84375" y2="1341.84375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>