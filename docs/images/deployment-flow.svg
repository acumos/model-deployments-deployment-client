<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1211" height="1236" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note over Portal_BE: User selects\n "deploy to k8s"
Portal_BE->Deployment\nClient: POST /deploy \n{solutionId, revisionId,\n envId, userId}
Deployment\nClient->Jenkins: Start Jenkins job with parameter taskId
Jenkins->Deployment\nClient: Job created
Deployment\nClient->CDS: POST /task {solId, revId, "taskCode": "DP",\n "statusCode": "IP", ...}
Deployment\nClient->Portal_BE: 202 Accepted\n {taskId}
Note over Portal_BE: Monitor task/stepresult\n and update UI as needed
Note over Jenkins: Jenkins jobs are preconfigured\n (simple, composite,\n pipeline) in configmap
Note over Jenkins: Execute deployment script
Jenkins->Deployment\nClient: POST /status/<taskId> {"status": "in-progress"}
Deployment\nClient->CDS: PUT /task/<taskId> {"statusCode": "IP", ...}
Deployment\nClient->CDS: POST /task/stepresult {taskId, "name": "DEP",\n "statusCode": "IP", ...}
Jenkins->Deployment\nClient: GET /getSolutionZip/taskId
Deployment\nClient->Jenkins: 202 OK (solution.zip)
Jenkins->k8s_Master: Create solution deployment
Note over Jenkins: Monitor progress
Jenkins->Deployment\nClient: POST /status/<taskId>\n {"status": "complete", "ingress": "<url>"}
Deployment\nClient->CDS: POST /task/stepresult {taskId, "name": "DEP",\n "statusCode": "SU", ...}
Deployment\nClient->CDS: PUT /task/<taskId> {"statusCode": "SU", ...}
Deployment\nClient->CDS: POST /notif\n {"message": "Deployment succeeded", "url": <url>, ...}]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="72.9296875" y="20" width="107.0625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.9296875" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.9296875">Portal_BE</tspan></text></g><g class="actor"><rect x="72.9296875" y="1158.46875" width="107.0625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="82.9296875" y="1193.0625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.9296875">Portal_BE</tspan></text></g><line x1="126.4609375" x2="126.4609375" y1="78.1875" y2="1158.46875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="320.3046875" y="20" width="116.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="330.3046875" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="330.3046875">Deployment</tspan><tspan dy="1.2em" x="330.3046875">Client</tspan></text></g><g class="actor"><rect x="320.3046875" y="1158.46875" width="116.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="330.3046875" y="1183.46875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="330.3046875">Deployment</tspan><tspan dy="1.2em" x="330.3046875">Client</tspan></text></g><line x1="378.6484375" x2="378.6484375" y1="78.1875" y2="1158.46875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="806.984375" y="20" width="88.796875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="817.984375" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="816.984375">Jenkins</tspan></text></g><g class="actor"><rect x="806.984375" y="1158.46875" width="88.796875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="817.984375" y="1193.0625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="816.984375">Jenkins</tspan></text></g><line x1="851.3828125" x2="851.3828125" y1="78.1875" y2="1158.46875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="986.921875" y="20" width="49.265625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="996.921875" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="996.921875">CDS</tspan></text></g><g class="actor"><rect x="986.921875" y="1158.46875" width="49.265625" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="996.921875" y="1193.0625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="996.921875">CDS</tspan></text></g><line x1="1011.5546875" x2="1011.5546875" y1="78.1875" y2="1158.46875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1063.3515625" y="20" width="117.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1073.3515625" y="54.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1073.3515625">k8s_Master</tspan></text></g><g class="actor"><rect x="1063.3515625" y="1158.46875" width="117.6875" height="58.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1073.3515625" y="1193.0625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1073.3515625">k8s_Master</tspan></text></g><line x1="1122.1953125" x2="1122.1953125" y1="78.1875" y2="1158.46875" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="49.21875" y="98.1875" width="154.484375" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="54.21875" y="118.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="54.21875">User selects</tspan><tspan dy="1.2em" x="54.21875">"deploy to k8s"</tspan></text></g><g class="signal"><text x="137.4609375" y="157.6796875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="136.4609375">POST /deploy</tspan><tspan dy="1.2em" x="136.4609375">{solutionId, revisionId,</tspan><tspan dy="1.2em" x="136.4609375">envId, userId}</tspan></text><line x1="126.4609375" x2="378.6484375" y1="223.765625" y2="223.765625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="426.9921875" y="254.265625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="426.9921875">Start Jenkins job with parameter taskId</tspan></text><line x1="378.6484375" x2="851.3828125" y1="262.765625" y2="262.765625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="562.3515625" y="293.265625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="561.3515625">Job created</tspan></text><line x1="851.3828125" x2="378.6484375" y1="301.765625" y2="301.765625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="488" y="322.671875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="488">POST /task {solId, revId, "taskCode": "DP",</tspan><tspan dy="1.2em" x="488">"statusCode": "IP", ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="359.953125" y2="359.953125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="194.578125" y="380.859375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="194.578125">202 Accepted</tspan><tspan dy="1.2em" x="194.578125">{taskId}</tspan></text><line x1="378.6484375" x2="126.4609375" y1="418.140625" y2="418.140625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="10" y="438.140625" width="232.921875" height="48.1875" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="16" y="458.140625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Monitor task/stepresult</tspan><tspan dy="1.2em" x="15">and update UI as needed</tspan></text></g><g class="note"><rect x="701.2109375" y="506.328125" width="300.34375" height="67.390625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="707.2109375" y="526.328125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="706.2109375">Jenkins jobs are preconfigured</tspan><tspan dy="1.2em" x="706.2109375">(simple, composite,</tspan><tspan dy="1.2em" x="706.2109375">pipeline) in configmap</tspan></text></g><g class="note"><rect x="725.7890625" y="593.71875" width="251.1875" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="730.7890625" y="613.71875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="730.7890625">Execute deployment script</tspan></text></g><g class="signal"><text x="388.6484375" y="653.21875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="388.6484375">POST /status/&lt;taskId&gt; {"status": "in-progress"}</tspan></text><line x1="851.3828125" x2="378.6484375" y1="661.71875" y2="661.71875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="483.1796875" y="692.21875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="483.1796875">PUT /task/&lt;taskId&gt; {"statusCode": "IP", ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="700.71875" y2="700.71875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="478.3671875" y="721.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="478.3671875">POST /task/stepresult {taskId, "name": "DEP",</tspan><tspan dy="1.2em" x="478.3671875">"statusCode": "IP", ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="758.90625" y2="758.90625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="490.109375" y="789.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="489.109375">GET /getSolutionZip/taskId</tspan></text><line x1="851.3828125" x2="378.6484375" y1="797.90625" y2="797.90625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="513.875" y="828.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="513.875">202 OK (solution.zip)</tspan></text><line x1="378.6484375" x2="851.3828125" y1="836.90625" y2="836.90625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="861.3828125" y="867.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="861.3828125">Create solution deployment</tspan></text><line x1="851.3828125" x2="1122.1953125" y1="875.90625" y2="875.90625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="768.640625" y="895.90625" width="165.484375" height="29" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="774.640625" y="915.90625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="773.640625">Monitor progress</tspan></text></g><g class="signal"><text x="412.7265625" y="945.8125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="412.7265625">POST /status/&lt;taskId&gt;</tspan><tspan dy="1.2em" x="412.7265625">{"status": "complete", "ingress": "&lt;url&gt;"}</tspan></text><line x1="851.3828125" x2="378.6484375" y1="983.09375" y2="983.09375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="478.3671875" y="1004" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="478.3671875">POST /task/stepresult {taskId, "name": "DEP",</tspan><tspan dy="1.2em" x="478.3671875">"statusCode": "SU", ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="1041.28125" y2="1041.28125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="483.1796875" y="1071.78125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="483.1796875">PUT /task/&lt;taskId&gt; {"statusCode": "SU", ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="1080.28125" y2="1080.28125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="435.015625" y="1101.1875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="435.015625">POST /notif</tspan><tspan dy="1.2em" x="435.015625">{"message": "Deployment succeeded", "url": &lt;url&gt;, ...}</tspan></text><line x1="378.6484375" x2="1011.5546875" y1="1138.46875" y2="1138.46875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>